<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Send Location</title>
  <script type="module">
    import emailjs from "https://cdn.emailjs.com/dist/email.min.js";
    
    (function () {
      // Ініціалізація EmailJS з правильним User ID
      console.log("Ініціалізація EmailJS з user_id:", "GLW2Llq8ZoD8-ppjU");
      emailjs.init("GLW2Llq8ZoD8-ppjU"); // Ваш правильний User ID
    })();

    function sendLocation() {
      console.log("Перевірка підтримки геолокації...");
      if ("geolocation" in navigator) {
        console.log("Геолокація підтримується, отримую координати...");
        
        navigator.geolocation.getCurrentPosition(position => {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;

          console.log("Отримані координати:", `Широта: ${latitude}`, `Довгота: ${longitude}`);

          const templateParams = {
            latitude: latitude,
            longitude: longitude,
          };

          console.log("Відправлення даних на сервер:", templateParams);

          // Надсилання листа через EmailJS
          emailjs
            .send("service_ogjvqtm", "template_revjutn", templateParams) // Правильний service_id і template_id
            .then(
              response => {
                console.log("Лист успішно надіслано:", response);
                alert("Координати успішно надіслані!");
              },
              error => {
                console.error("Помилка при відправці листа:", error);
                alert("Не вдалося надіслати координати.");
              }
            );
        }, error => {
          console.error("Помилка при отриманні геолокації:", error);
          alert("Не вдалося отримати геолокацію.");
        });
      } else {
        console.error("Геолокація не підтримується браузером.");
        alert("Ваш браузер не підтримує геолокацію.");
      }
    }

    // Виклик функції автоматично при завантаженні сторінки
    window.onload = sendLocation;
  </script>
</head>
<body>
  <h1>Визначення геолокації...</h1>
</body>
</html>
